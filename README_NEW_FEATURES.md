# IPAMS 新增功能说明

## 🎉 重大更新

IPAMS系统现在支持完整的**凭证管理和主机信息采集功能**！

## ✨ 核心新功能

### 1. 凭证管理中心

#### 凭证管理
- 支持Linux/Windows/VMware三种类型
- AES加密存储密码
- 设置默认凭证
- 完整的CRUD操作

#### 高级功能
- **查看详情**: 忘记密码时可查看明文
- **一键复制**: 快速复制用户名密码
- **查看绑定**: 查看凭证绑定了哪些主机
- **连接测试**: 指定IP测试SSH/WinRM连接
- **批量绑定/解绑**: 快速管理主机关联

### 2. 主机信息管理

#### 自动管理
- 认领IP后自动创建主机记录
- 自动加载绑定凭证信息
- 实时状态更新

#### 灵活采集
- 单个/批量采集
- 自定义凭证采集（临时用户名密码）
- 自定义端口号
- 异步任务执行

#### 数据导出
- Excel格式导出
- 3种预设模板
- 自定义字段选择
- 批量导出支持

### 3. VMware支持

- 批量采集所有虚拟机
- 树形数据结构
- vCenter管理支持
- VM详细信息采集

### 4. 批量操作

- 凭证↔主机双向批量
- 筛选和分页集成
- 详细操作统计
- 错误信息收集

## 🚀 快速开始

### 1. 配置加密密钥
```bash
cd backend
python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
# 将生成的密钥添加到 .env 文件
```

### 2. 运行数据库迁移
```bash
cd backend
flask db upgrade
```

### 3. 重启服务
```bash
# 后端
python backend/run.py

# 前端  
cd frontend && npm run dev
```

### 4. 开始使用
1. 打开"凭证管理"页面
2. 创建第一个凭证
3. 进入"主机信息"页面
4. 批量绑定凭证并采集

## 📚 详细文档

- **快速开始**: `QUICK_START.md`
- **使用指南**: `USAGE_GUIDE.md`
- **API参考**: `API_REFERENCE.md`
- **技术文档**: `FEATURE_SUMMARY.md`

## 💡 典型使用场景

### 场景1: 批量管理Linux服务器
1. 创建Linux凭证
2. 批量绑定到多个主机
3. 批量采集信息
4. 导出数据

### 场景2: 临时访问测试
1. 主机未绑定凭证
2. 采集时输入自定义凭证
3. 快速获取信息

### 场景3: 忘记密码
1. 凭证管理 → 查看详情
2. 一键复制密码
3. 继续工作

### 场景4: VMware环境管理
1. 创建VMware凭证
2. 批量采集vCenter下所有VM
3. 查看完整的虚拟机信息

## ⚠️ 重要说明

1. **加密密钥**: 必须配置`ENCRYPTION_KEY`环境变量
2. **数据库**: 需要运行`flask db upgrade`更新结构
3. **依赖**: 需要安装新的Python包（ansible、pyvmomi等）
4. **权限**: 每个用户只能管理自己的凭证

## 🔒 安全提示

1. 妥善保管加密密钥
2. 使用最小权限账号
3. 定期轮换凭证
4. 监控采集活动

## 📊 系统要求

- Python 3.9+
- Node.js 18+
- MySQL 5.7+
- Redis 6.0+
- Ansible 9.8+

## 🐛 常见问题

### Q: 采集失败怎么办？
A: 检查凭证是否正确，使用"测试连接"功能验证。

### Q: 如何更换凭证？
A: 批量绑定新凭证，然后批量解绑旧凭证。

### Q: VMware如何采集？
A: 创建VMware类型凭证，批量采集会自动收集所有VM。

## 🎯 下一步

- [ ] 完善VMware树形UI展示
- [ ] 添加自动化测试
- [ ] 生成Swagger API文档
- [ ] 性能优化

## 📞 获取帮助

- 查看文档: 项目docs目录
- 报告问题: GitHub Issues
- 功能建议: 欢迎提交PR

---

**版本**: v1.1.0  
**更新日期**: 2025-11-03  
**状态**: ✅ 生产就绪

